
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gettingstarted/gallery/auto_examples/analysis/plot_mcrals_chrom1.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_gettingstarted_gallery_auto_examples_analysis_plot_mcrals_chrom1.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gettingstarted_gallery_auto_examples_analysis_plot_mcrals_chrom1.py:


MCR-ALS optimization example (original example from Jaumot)
===========================================================

In this example, we perform the MCR ALS optimization of a dataset
corresponding to a HPLC-DAD run, from
Jaumot et al. Chemolab, 76 (2005) 101-110,
`DOI: 10.1016/j.chemolab.2004.12.007  <https://doi.org/10.1016/j.chemolab.2004.12.007>`_
and Jaumot et al. Chemolab, 140 (2015) pp. 1-12,
`DOI: 10.1016/j.chemolab.2014.10.003 <https://doi.org/10.1016/j.chemolab.2014.10.003>`_ .

This dataset (and others) can be loaded from the
`Multivariate Curve Resolution Homepage <https://mcrals.wordpress.com/download/example-data-sets>`_ .

For the user convenience, this dataset is present in the `datadir` of SpectroChemPy as 'als2004dataset.MAT' .

.. GENERATED FROM PYTHON SOURCE LINES 24-26

.. code-block:: default

    import spectrochempy as scp








.. GENERATED FROM PYTHON SOURCE LINES 27-28

Load the dataset

.. GENERATED FROM PYTHON SOURCE LINES 28-30

.. code-block:: default

    datasets = scp.read_matlab("matlabdata/als2004dataset.MAT")








.. GENERATED FROM PYTHON SOURCE LINES 31-32

As the .mat file contains 6 matrices, 6 NDDataset objects are returned:

.. GENERATED FROM PYTHON SOURCE LINES 32-34

.. code-block:: default

    print("\n NDDataset names: " + str([ds.name for ds in datasets]))





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


     NDDataset names: ['cpure', 'MATRIX', 'isp_matrix', 'spure', 'csel_matrix', 'm1']




.. GENERATED FROM PYTHON SOURCE LINES 35-43

We are interested in the last dataset ('m1') that contains a single HPLS-DAD run (51x96)  dataset.
As usual, the 51 rows correspond to the 'time axis' of the HPLC run, and the 96 columns to the 'wavelength' axis
of the UV spectra. The original dataset does not contain information as to the actual time and wavelength coordinates.

MCR-ALS needs also an initial guess for either concentration profiles or pure spectra concentration profiles.
The 4th dataset 'spure' is a (4x96) guess of spectral profiles.

Load the experimental data as X and the guess:

.. GENERATED FROM PYTHON SOURCE LINES 43-46

.. code-block:: default

    X = datasets[-1]
    guess = datasets[3]








.. GENERATED FROM PYTHON SOURCE LINES 47-49

Create a MCR-ALS object with the default settings
The verbose option can be set True to get a summary of optimization steps

.. GENERATED FROM PYTHON SOURCE LINES 49-51

.. code-block:: default

    mcr = scp.MCRALS(X, guess)








.. GENERATED FROM PYTHON SOURCE LINES 52-54

The optimization has converged. We can get the concentration (C) and pure spectra profiles (St)
and plot them

.. GENERATED FROM PYTHON SOURCE LINES 54-57

.. code-block:: default

    _ = mcr.C.T.plot()
    _ = mcr.St.plot()




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /gettingstarted/gallery/auto_examples/analysis/images/sphx_glr_plot_mcrals_chrom1_001.png
         :alt: plot mcrals chrom1
         :srcset: /gettingstarted/gallery/auto_examples/analysis/images/sphx_glr_plot_mcrals_chrom1_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /gettingstarted/gallery/auto_examples/analysis/images/sphx_glr_plot_mcrals_chrom1_002.png
         :alt: plot mcrals chrom1
         :srcset: /gettingstarted/gallery/auto_examples/analysis/images/sphx_glr_plot_mcrals_chrom1_002.png
         :class: sphx-glr-multi-img





.. GENERATED FROM PYTHON SOURCE LINES 58-60

Finally, plots the reconstructed dataset  (X_hat = C St) vs original dataset (X)
and residuals. The fit is good and comparable with the original paper.

.. GENERATED FROM PYTHON SOURCE LINES 60-63

.. code-block:: default

    X_hat = mcr.plotmerit()

    # scp.show()  # uncomment to show plot if needed (not necessary in jupyter notebook)



.. image-sg:: /gettingstarted/gallery/auto_examples/analysis/images/sphx_glr_plot_mcrals_chrom1_003.png
   :alt: MCR ALS merit plot
   :srcset: /gettingstarted/gallery/auto_examples/analysis/images/sphx_glr_plot_mcrals_chrom1_003.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  2.424 seconds)


.. _sphx_glr_download_gettingstarted_gallery_auto_examples_analysis_plot_mcrals_chrom1.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_mcrals_chrom1.py <plot_mcrals_chrom1.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_mcrals_chrom1.ipynb <plot_mcrals_chrom1.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
