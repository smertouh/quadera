<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MCR-ALS optimization example (original example from Jaumot) &mdash; SpectroChemPy v0.4.7 0.4.7 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/theme_override.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../_static/scpy.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/clipboard.min.js"></script>
        <script src="../../../../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="NDDataset PCA analysis example" href="plot_pca_spec.html" />
    <link rel="prev" title="Example’s gallery" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html">
            <img src="../../../../_static/scpy.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.4.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
      <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> SpectroChemPy </span>
        version: stable
        <span class="fa fa-caret-down"></span>
      </span>
        <div class="rst-other-versions">
            <dl>
                <dt>Other versions</dt>
                
                    
                        <dd><a href="https://www.spectrochempy.fr/latest/index.html"">LATEST</a></dd>
                    
                
                    
                
            </dl>
            <hr/>
            <dl>
                <dt>Sources on GitHub</dt>
                <dd><a href="https://github.com/spectrochempy/spectrochempy/releases/latest">Stable</a></dd>
                <dd><a href="https://github.com/spectrochempy/spectrochempy/tree/master/">Latest</a></dd>

            </dl>

        </div>
    </div>

    
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../index.html">Home</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../whyscpy.html">Why <strong>SpectroChemPy</strong>  ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#example-of-the-analysis-package-usage">Example of the analysis package usage</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">MCR-ALS optimization example (original example from Jaumot)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_pca_spec.html">NDDataset PCA analysis example</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_efa.html">EFA analysis example</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_pca_iris.html">PCA analysis example</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_efa_keller_massart.html">EFA analysis (Keller and Massart original example)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_2D_iris.html">2D-IRIS analysis example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#example-of-the-fitting-package-usage">Example of the fitting package usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#how-to-use-nddataset">How to use NDDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#plotting-dataset-examples">Plotting dataset examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#processing-dataset-examples">Processing dataset examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#project-management">Project Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#read-write">Read / Write</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../papers.html">Papers citing <strong>SpectroChemPy</strong></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User's Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../userguide/introduction/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../userguide/objects.html">Data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../userguide/importexport/importexport.html">Import &amp; Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../userguide/plotting/plotting.html">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../userguide/processing/processing.html">Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../userguide/analysis/analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../userguide/units/units.html">Units &amp; Quantities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../userguide/databases/databases.html">Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../userguide/api/api.html">API Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference &amp; Help</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../userguide/reference/changelog.html">What’s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../userguide/reference/index.html">Public API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../userguide/reference/faq.html">Frequently asked questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../devguide/issues.html">Bug reports &amp; feature request</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../devguide/examples.html">Sharing examples &amp; tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../devguide/index.html">Developer’s Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Credits</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../credits/credits.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../credits/credits.html#third-party-licences">Third-party Licences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../credits/citing.html">Citing  <strong>SpectroChemPy</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../credits/license.html">SpectroChempy License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../credits/license.html#other-licenses">Other Licenses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../credits/seealso.html">See also</a></li>
</ul>



        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">SpectroChemPy v0.4.7</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Example’s gallery</a> &raquo;</li>
      <li>MCR-ALS optimization example (original example from Jaumot)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/gettingstarted/gallery/auto_examples/analysis/plot_mcrals_chrom1.rst" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-gettingstarted-gallery-auto-examples-analysis-plot-mcrals-chrom1-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="mcr-als-optimization-example-original-example-from-jaumot">
<span id="sphx-glr-gettingstarted-gallery-auto-examples-analysis-plot-mcrals-chrom1-py"></span><h1>MCR-ALS optimization example (original example from Jaumot)<a class="headerlink" href="#mcr-als-optimization-example-original-example-from-jaumot" title="Permalink to this headline">¶</a></h1>
<p>In this example, we perform the MCR ALS optimization of a dataset
corresponding to a HPLC-DAD run, from
Jaumot et al. Chemolab, 76 (2005) 101-110,
<a class="reference external" href="https://doi.org/10.1016/j.chemolab.2004.12.007">DOI: 10.1016/j.chemolab.2004.12.007</a>
and Jaumot et al. Chemolab, 140 (2015) pp. 1-12,
<a class="reference external" href="https://doi.org/10.1016/j.chemolab.2014.10.003">DOI: 10.1016/j.chemolab.2014.10.003</a> .</p>
<p>This dataset (and others) can be loaded from the
<a class="reference external" href="https://mcrals.wordpress.com/download/example-data-sets">Multivariate Curve Resolution Homepage</a> .</p>
<p>For the user convenience, this dataset is present in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">datadir</span></code> of SpectroChemPy as ‘als2004dataset.MAT’ .</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">spectrochempy</span> <span class="k">as</span> <span class="nn">scp</span>
</pre></div>
</div>
<p>Load the dataset</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">datasets</span></a> <span class="o">=</span> <a href="../../../../userguide/reference/generated/spectrochempy.read_matlab.html#spectrochempy.read_matlab" title="spectrochempy.read_matlab" class="sphx-glr-backref-module-spectrochempy sphx-glr-backref-type-py-function"><span class="n">scp</span><span class="o">.</span><span class="n">read_matlab</span></a><span class="p">(</span><span class="s2">&quot;matlabdata/als2004dataset.MAT&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>As the .mat file contains 6 matrices, 6 NDDataset objects are returned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> NDDataset names: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">([</span><span class="n">ds</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">datasets</span></a><span class="p">]))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>NDDataset names: [&#39;cpure&#39;, &#39;MATRIX&#39;, &#39;isp_matrix&#39;, &#39;spure&#39;, &#39;csel_matrix&#39;, &#39;m1&#39;]
</pre></div>
</div>
<p>We are interested in the last dataset (‘m1’) that contains a single HPLS-DAD run (51x96)  dataset.
As usual, the 51 rows correspond to the ‘time axis’ of the HPLC run, and the 96 columns to the ‘wavelength’ axis
of the UV spectra. The original dataset does not contain information as to the actual time and wavelength coordinates.</p>
<p>MCR-ALS needs also an initial guess for either concentration profiles or pure spectra concentration profiles.
The 4th dataset ‘spure’ is a (4x96) guess of spectral profiles.</p>
<p>Load the experimental data as X and the guess:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../../../userguide/reference/generated/spectrochempy.NDDataset.html#spectrochempy.NDDataset" title="spectrochempy.NDDataset" class="sphx-glr-backref-module-spectrochempy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">datasets</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a href="../../../../userguide/reference/generated/spectrochempy.NDDataset.html#spectrochempy.NDDataset" title="spectrochempy.NDDataset" class="sphx-glr-backref-module-spectrochempy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">guess</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">datasets</span></a><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>Create a MCR-ALS object with the default settings
The verbose option can be set True to get a summary of optimization steps</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../../../userguide/reference/generated/spectrochempy.MCRALS.html#spectrochempy.MCRALS" title="spectrochempy.MCRALS" class="sphx-glr-backref-module-spectrochempy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mcr</span></a> <span class="o">=</span> <a href="../../../../userguide/reference/generated/spectrochempy.MCRALS.html#spectrochempy.MCRALS" title="spectrochempy.MCRALS" class="sphx-glr-backref-module-spectrochempy sphx-glr-backref-type-py-class"><span class="n">scp</span><span class="o">.</span><span class="n">MCRALS</span></a><span class="p">(</span><a href="../../../../userguide/reference/generated/spectrochempy.NDDataset.html#spectrochempy.NDDataset" title="spectrochempy.NDDataset" class="sphx-glr-backref-module-spectrochempy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a><span class="p">,</span> <a href="../../../../userguide/reference/generated/spectrochempy.NDDataset.html#spectrochempy.NDDataset" title="spectrochempy.NDDataset" class="sphx-glr-backref-module-spectrochempy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">guess</span></a><span class="p">)</span>
</pre></div>
</div>
<p>The optimization has converged. We can get the concentration (C) and pure spectra profiles (St)
and plot them</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <a href="../../../../userguide/reference/generated/spectrochempy.MCRALS.C.html#spectrochempy.MCRALS.C" title="spectrochempy.MCRALS.C" class="sphx-glr-backref-module-spectrochempy sphx-glr-backref-type-py-property"><span class="n">mcr</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">plot</span></a><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <a href="../../../../userguide/reference/generated/spectrochempy.MCRALS.St.html#spectrochempy.MCRALS.St" title="spectrochempy.MCRALS.St" class="sphx-glr-backref-module-spectrochempy sphx-glr-backref-type-py-property"><span class="n">mcr</span><span class="o">.</span><span class="n">St</span><span class="o">.</span><span class="n">plot</span></a><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../../../_images/sphx_glr_plot_mcrals_chrom1_001.png" srcset="../../../../_images/sphx_glr_plot_mcrals_chrom1_001.png" alt="plot mcrals chrom1" class = "sphx-glr-multi-img"/></li>
<li><img src="../../../../_images/sphx_glr_plot_mcrals_chrom1_002.png" srcset="../../../../_images/sphx_glr_plot_mcrals_chrom1_002.png" alt="plot mcrals chrom1" class = "sphx-glr-multi-img"/></li>
</ul>
<p>Finally, plots the reconstructed dataset  (X_hat = C St) vs original dataset (X)
and residuals. The fit is good and comparable with the original paper.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X_hat</span> <span class="o">=</span> <a href="../../../../userguide/reference/generated/spectrochempy.MCRALS.plotmerit.html#spectrochempy.MCRALS.plotmerit" title="spectrochempy.MCRALS.plotmerit" class="sphx-glr-backref-module-spectrochempy sphx-glr-backref-type-py-method"><span class="n">mcr</span><span class="o">.</span><span class="n">plotmerit</span></a><span class="p">()</span>

<span class="c1"># scp.show()  # uncomment to show plot if needed (not necessary in jupyter notebook)</span>
</pre></div>
</div>
<img src="../../../../_images/sphx_glr_plot_mcrals_chrom1_003.png" srcset="../../../../_images/sphx_glr_plot_mcrals_chrom1_003.png" alt="MCR ALS merit plot" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.836 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-gettingstarted-gallery-auto-examples-analysis-plot-mcrals-chrom1-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../../../_downloads/ce24139aa79a3379ded7dcdca7033f49/plot_mcrals_chrom1.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_mcrals_chrom1.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../../../_downloads/2978182e8198ef1875ecb10ce10bc566/plot_mcrals_chrom1.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_mcrals_chrom1.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
          </div>

          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Example’s gallery" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plot_pca_spec.html" class="btn btn-neutral float-right" title="NDDataset PCA analysis example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2014-2022 - A.Travert &amp; C.Fernandez @ LCS.
      <span class="lastupdated">Last updated on May 16, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>